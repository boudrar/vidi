Marionette.View=Backbone.View.extend({constructor:function(t){_.bindAll(this,"render"),this.options=_.extend({},_.result(this,"options"),_.isFunction(t)?t.call(this):t),this._behaviors=Marionette.Behaviors(this),Backbone.View.apply(this,arguments),Marionette.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled)},getTemplate:function(){return this.getOption("template")},serializeModel:function(t){return t.toJSON.apply(t,slice.call(arguments,1))},mixinTemplateHelpers:function(t){t=t||{};var e=this.getOption("templateHelpers");return _.isFunction(e)&&(e=e.call(this)),_.extend(t,e)},normalizeUIKeys:function(t){var e=_.result(this,"ui"),i=_.result(this,"_uiBindings");return Marionette.normalizeUIKeys(t,i||e)},normalizeUIValues:function(t){var e=_.result(this,"ui"),i=_.result(this,"_uiBindings");return Marionette.normalizeUIValues(t,i||e)},configureTriggers:function(){if(this.triggers){var t={},e=this.normalizeUIKeys(_.result(this,"triggers"));return _.each(e,function(e,i){t[i]=this._buildViewTrigger(e)},this),t}},delegateEvents:function(t){return this._delegateDOMEvents(t),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),_.each(this._behaviors,function(t){t.bindEntityEvents(this.model,t.getOption("modelEvents")),t.bindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(t){var e=t||this.events;_.isFunction(e)&&(e=e.call(this)),e=this.normalizeUIKeys(e),_.isUndefined(t)&&(this.events=e);var i={},n=_.result(this,"behaviorEvents")||{},s=this.configureTriggers(),o=_.result(this,"behaviorTriggers")||{};_.extend(i,n,e,s,o),Backbone.View.prototype.delegateEvents.call(this,i)},undelegateEvents:function(){var t=slice.call(arguments);return Backbone.View.prototype.undelegateEvents.apply(this,t),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),_.each(this._behaviors,function(t){t.unbindEntityEvents(this.model,t.getOption("modelEvents")),t.unbindEntityEvents(this.collection,t.getOption("collectionEvents"))},this),this},onShowCalled:function(){},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new Marionette.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(!this.isDestroyed){var t=slice.call(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(t)),this.unbindUIElements(),this.remove(),_.invoke(this._behaviors,"destroy",t),this}},bindUIElements:function(){this._bindUIElements(),_.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=_.result(this,"_uiBindings");this.ui={},_.each(_.keys(t),function(e){var i=t[e];this.ui[e]=this.$(i)},this)}},unbindUIElements:function(){this._unbindUIElements(),_.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(_.each(this.ui,function(t,e){delete this.ui[e]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(t){var e=_.isObject(t),i=_.defaults({},e?t:{},{preventDefault:!0,stopPropagation:!0}),n=e?i.event:t;return function(t){t&&(t.preventDefault&&i.preventDefault&&t.preventDefault(),t.stopPropagation&&i.stopPropagation&&t.stopPropagation());var e={view:this,model:this.model,collection:this.collection};this.triggerMethod(n,e)}},setElement:function(){var t=Backbone.View.prototype.setElement.apply(this,arguments);return _.invoke(this._behaviors,"proxyViewProperties",this),t},triggerMethod:function(){var t=arguments,e=Marionette.triggerMethod,i=e.apply(this,t);return _.each(this._behaviors,function(i){e.apply(i,t)}),i},normalizeMethods:Marionette.normalizeMethods,getOption:Marionette.proxyGetOption,bindEntityEvents:Marionette.proxyBindEntityEvents,unbindEntityEvents:Marionette.proxyUnbindEntityEvents});